### Thread
- Light Weight Process
- 프로세스 내에서 생성되는 흐름의 단위
- 일반적으로 한 프로세스에 한 스레드이지만 프로그램 환경에 따라 두 개 이상의 스레드 실행이 가능

#### 특징
- 프로세스와 달리 별도의 통신 기법(IPC 등) 없이 스레드간 자원 공유 가능
- 각 스레드에는 각기 실행이 가능한 stack이 존재(code, data, heap 영역은 공유하면서 별도의 stack을 실행)
- 소프트웨어 병행 작업처리 가능(멀티 스레드)

#### 장점
- CPU 활용도, 성능 증가
- 응답성 향상

#### 단점
- 하나의 스레드 문제가, 프로세스 전반에 영향을 미침
- 여러 스레드 생성시 성능 저하 가능성 존재(Context Swicthing이 빈번하게 일어나..)

#### 동기화(Synchronization) 이슈
- 동기화: 작업들 사이에 실행 시기를 맞추는 것
- 여러 스레드가 동일한 자원(데이터)에 접근 시 동기화 이슈 발생
  - 동일 자원을 여러 스레드가 동시 수정시, 각 스레드 결과에 영향을 줌

- 해결방안
  - Mutual exclusion(상호 배제)
  - 여러 스레드가 변경하는(접근 가능한) 자원에 대해 Exclusive Access 필요(자원이 수정되고 있을 때 다른 스레드의 접근을 막는다)

#### Mutex와 Semaphore
- 임계구역에 대한 접근을 막기 위한 Locking 매커니즘
- Mutex(binary semaphore)
  - 임계구역에 하나의 스레드만 들어갈 수 있음
- Semaphore
  - 임계구역에 여러 스레드가 들어갈 수 있음
  - counter를 두어 동시에 리소스에 접근 할 수 있는 허용 가능한 스레드 수를 제어
```
P(S): wait(S) {
    while S <= 0; //대기
    S--; // 다른 프로세스 접근 제한
}
```
```
V(S): signal(S) {
    S++; // 다른 프로세스 접근 허용
}
```
- V : 세마포어 값
- P : 검사 (임계영역 들어갈 때)
- V : 증가 (임계영역에서 나올 때)
- loop는 무중단으로 부하 걸림(바쁜대기) -> 대기 큐로 보완
```
wait(S) {
    S -> count--;
    if (S -> count <= 0) {
        add thiss process to S -> queue;
        block()
    }
}
```

#### 교착상태와 기아상태
##### 교착상태
- 무한 대기 상태: 두 개 이상의 작업이 서로 상대방의 작업이 끝나기 만을 기다리고 있기 때문에, 다음 단계로 진행하지 못하는 상태
- 배치 처리 시스템에서는 일어나지 않는 문제(프로세스와 스레드는 이와 같은 상태가 일어날 수 있음)
- 교착상태 발생 조건(4가지 모두 성립될 때, 발생 가능성 있음)
  1) 상호배제(Mutual exclusion): 프로세스들이 필요로 하는 자원에 대해 배타적인 통제권을 요구
  2) 점유대기(Hold and Wait): 프로세스가 할당된 자원을 가진 상태에서 다른 자원을 기다린다
  3) 비선점(No preemption): 프로세스가 어떤 자원의 사용을 끝낼 때까지 그 자원을 뺏을 수 없다.
  4) 순환대기(Circular wait): 각 프로세스는 순환적으로 다음 프로세스가 요구하는 자원을 가지고 있다.
- 교착상태 해결방법
  1) 교착상태 예방
     - 상호배제 조건 제거(임계영역 제거)
     - 점유와 대기 조건 제거(한번에 모든 필요 자원 점유 해제)
     - 비선점 조건 제거(선점 가능 기법을 만들어줌)
     - 순환 대기 조건 제거(자원 유형에 따라 순서를 매김)
  2) 교착상태 회피
     - 순환 대기 조건 제거만 실행(나머지 실행 시 프로세스 실행 비효율성이 증대됨)
  3) 교착상태 발견 - 교착 상태 발생 여부 점검하여 발견하는 것
  4) 교착상태 회복 - 교착 상태를 일으킨 프로세스를 종료하거나 교착상태의 프로세스에 할당된 자원을 선점하여 프로세스나 자원을 회복하는 것

##### 기아상태
- 특정 프로세스의 우선순위가 낮아서 원하는 자원을 계속 할당받지 못하는 상태
- 교착상태는 여러 프로세스가 동일 자원 점유를 요청할 때 발생
- 기아상태는 프로세스간 우선순위 경쟁에서 특정 프로세스가 영원히 자원 할당이 안되는 경우
- 해결방법
  - 프로세스 우선순위를 수시로 변경
  - 오래 기다린 프로세스 우선순위 높여주기
  - FIFO 기반 요청 큐 사용

